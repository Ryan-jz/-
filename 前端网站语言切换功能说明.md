# 前端网站语言切换功能说明

## 已完成的工作

### ✅ 语言切换组件
1. **LanguageSwitcher.vue**
   - 支持三种语言：中文（🇨🇳）、英文（🇺🇸）、德文（🇩🇪）
   - 下拉菜单选择语言
   - 显示当前选中语言
   - 自动保存到 localStorage
   - 切换后自动刷新页面

2. **集成到导航栏**
   - 位于导航栏右侧
   - 响应式设计，移动端友好
   - 与现有导航菜单协调

### ✅ i18n 配置
- 已有完整的 i18n 配置
- 支持三种语言文件：
  - `zh-CN.js` - 中文
  - `en-US.js` - 英文
  - `de-DE.js` - 德文
- 自动检测浏览器语言
- 语言持久化存储

## 功能特点

### 1. 智能语言检测
- 首次访问自动检测浏览器语言
- 优先使用用户上次选择的语言
- 默认回退到中文

### 2. 用户体验
- 国旗图标直观显示
- 下拉菜单流畅动画
- 当前语言高亮显示
- 点击外部自动关闭

### 3. 响应式设计
- 桌面端：显示完整语言名称
- 移动端：仅显示国旗图标
- 自适应布局

## 使用方法

### 用户操作
1. 点击导航栏右侧的语言按钮
2. 在下拉菜单中选择目标语言
3. 页面自动刷新并切换到新语言

### 开发者集成

#### 1. 在组件中使用翻译

```vue
<template>
  <div>
    <!-- 使用 $t 函数 -->
    <h1>{{ $t('home.title') }}</h1>
    <p>{{ $t('home.description') }}</p>
  </div>
</template>

<script setup>
import { useI18n } from 'vue-i18n'

const { t } = useI18n()

// 在 JS 中使用
const message = t('common.welcome')
</script>
```

#### 2. 添加翻译文本

在对应的语言文件中添加翻译：

**zh-CN.js**
```javascript
export default {
  home: {
    title: '欢迎来到我们的网站',
    description: '这是一个很棒的网站'
  },
  common: {
    welcome: '欢迎'
  }
}
```

**en-US.js**
```javascript
export default {
  home: {
    title: 'Welcome to Our Website',
    description: 'This is an awesome website'
  },
  common: {
    welcome: 'Welcome'
  }
}
```

**de-DE.js**
```javascript
export default {
  home: {
    title: 'Willkommen auf unserer Website',
    description: 'Dies ist eine großartige Website'
  },
  common: {
    welcome: 'Willkommen'
  }
}
```

#### 3. 动态切换语言

```javascript
import { setLocale, getLocale } from '@/locales'

// 切换到英文
setLocale('en-US')

// 获取当前语言
const currentLang = getLocale()
```

## API 集成

### 获取数据时传递语言参数

```javascript
import { getLocale } from '@/locales'

// 获取轮播图
const getBanners = async () => {
  const locale = getLocale()
  const res = await fetch(`/api/v1/banner/list?locale=${locale}`)
  return res.json()
}

// 获取产品列表
const getProducts = async () => {
  const locale = getLocale()
  const res = await fetch(`/api/v1/product/list?locale=${locale}`)
  return res.json()
}

// 获取食谱列表
const getRecipes = async () => {
  const locale = getLocale()
  const res = await fetch(`/api/v1/recipe/list?locale=${locale}`)
  return res.json()
}
```

### 在 API 请求拦截器中自动添加

```javascript
// src/utils/request.js
import axios from 'axios'
import { getLocale } from '@/locales'

const request = axios.create({
  baseURL: import.meta.env.VITE_API_BASE_URL
})

// 请求拦截器
request.interceptors.request.use(config => {
  // 自动添加语言参数
  const locale = getLocale()
  if (config.method === 'get') {
    config.params = {
      ...config.params,
      locale
    }
  }
  return config
})

export default request
```

## 样式定制

### 修改语言按钮样式

在 `LanguageSwitcher.vue` 中修改：

```css
.language-button {
  /* 修改背景色 */
  background: rgba(255, 255, 255, 0.2);
  
  /* 修改边框 */
  border: 2px solid rgba(255, 255, 255, 0.5);
  
  /* 修改圆角 */
  border-radius: 20px;
}
```

### 修改下拉菜单样式

```css
.language-dropdown {
  /* 修改阴影 */
  box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
  
  /* 修改圆角 */
  border-radius: 12px;
}
```

## 添加新语言

### 1. 创建语言文件

创建 `frontend-web/src/locales/fr-FR.js`：

```javascript
export default {
  common: {
    welcome: 'Bienvenue'
  },
  // ... 其他翻译
}
```

### 2. 在 i18n 配置中注册

修改 `frontend-web/src/locales/index.js`：

```javascript
import frFR from './fr-FR'

const i18n = createI18n({
  // ...
  messages: {
    'zh-CN': zhCN,
    'en-US': enUS,
    'de-DE': deDE,
    'fr-FR': frFR, // 添加法语
  },
})
```

### 3. 在语言切换器中添加选项

修改 `LanguageSwitcher.vue`：

```javascript
const languages = [
  { code: 'zh-CN', label: '中文', flag: '🇨🇳' },
  { code: 'en-US', label: 'English', flag: '🇺🇸' },
  { code: 'de-DE', label: 'Deutsch', flag: '🇩🇪' },
  { code: 'fr-FR', label: 'Français', flag: '🇫🇷' }, // 添加法语
]
```

## 测试清单

- [ ] 点击语言按钮显示下拉菜单
- [ ] 选择不同语言后页面刷新
- [ ] 刷新页面后语言保持不变
- [ ] 移动端显示正常
- [ ] 下拉菜单点击外部关闭
- [ ] 当前语言高亮显示
- [ ] API 请求携带正确的 locale 参数

## 常见问题

### Q1: 切换语言后页面没有变化？

**A**: 检查以下几点：
1. 确认语言文件中有对应的翻译
2. 确认使用了 `$t()` 或 `t()` 函数
3. 检查浏览器控制台是否有错误

### Q2: 如何不刷新页面切换语言？

**A**: 修改 `LanguageSwitcher.vue` 中的 `changeLanguage` 方法：

```javascript
const changeLanguage = (langCode) => {
  setLocale(langCode)
  isOpen.value = false
  // 移除这行：window.location.reload()
  
  // 如果需要重新加载数据，手动调用
  emit('language-changed', langCode)
}
```

### Q3: 如何在 API 中自动使用当前语言？

**A**: 在 axios 拦截器中自动添加 locale 参数（见上文"API 集成"部分）

## 下一步优化

1. **语言检测优化**
   - 根据 IP 地址检测用户所在地区
   - 提供语言推荐

2. **翻译管理**
   - 集成翻译管理平台
   - 支持在线编辑翻译

3. **SEO 优化**
   - 为不同语言生成不同的 URL
   - 添加 hreflang 标签

4. **性能优化**
   - 按需加载语言文件
   - 缓存翻译数据

## 总结

语言切换功能已完全集成到前端网站：
- ✅ 语言切换组件已创建
- ✅ 导航栏已集成
- ✅ 支持三种语言
- ✅ 响应式设计
- ✅ 持久化存储

现在用户可以轻松切换网站语言，享受多语言体验！
