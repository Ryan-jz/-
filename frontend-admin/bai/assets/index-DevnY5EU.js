import{s as y}from"./index-D6S6O2v3.js";import{_ as ae}from"./_plugin-vue_export-helper-DlAUqK2U.js";import{b as oe,E as U}from"./element-plus-BcUKyH_i.js";import{l as R,r as f,j as ne,B as se,C as e,D as t,ak as n,aq as ue,z,J as re,M as r,y as q,E as de,O as F,K as ie}from"./vue-vendor-BRUv3CCy.js";function pe(p){return y({url:"/admin/user/list",method:"get",params:p})}function me(p){return y({url:"/admin/user/create",method:"post",data:p})}function fe(p){return y({url:"/admin/user/update",method:"put",data:p})}function _e(p){return y({url:"/admin/user/delete",method:"delete",data:{userId:p}})}const be={class:"user-container"},ge={__name:"index",setup(p){const s=R({userName:"",phonenumber:"",status:null,page:1,pageSize:10}),D=f([]),E=f(0),w=f(!1),b=f(!1),x=f("新增用户"),g=f(!1),N=f(!1),C=f(null),o=R({userId:null,userName:"",nickName:"",password:"",email:"",phonenumber:"",sex:"0",status:0,deptId:100,remark:""}),T={userName:[{required:!0,message:"请输入用户名",trigger:"blur"}],nickName:[{required:!0,message:"请输入昵称",trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]},V=async()=>{w.value=!0;try{const u=await pe(s);D.value=u.data.list||[],E.value=u.data.total||0}catch(u){console.error("获取用户列表失败：",u)}finally{w.value=!1}},k=()=>{s.page=1,V()},j=()=>{s.userName="",s.phonenumber="",s.status=null,k()},L=()=>{g.value=!1,x.value="新增用户",b.value=!0},M=u=>{g.value=!0,x.value="编辑用户",Object.assign(o,u),b.value=!0},O=u=>{oe.confirm("确定要删除该用户吗？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(async()=>{try{await _e(u.userId),U.success("删除成功"),V()}catch(l){console.error("删除失败：",l)}})},P=async()=>{if(await C.value.validate().catch(()=>!1)){N.value=!0;try{g.value?(await fe(o),U.success("更新成功")):(await me(o),U.success("创建成功")),b.value=!1,V()}catch(l){console.error("提交失败：",l)}finally{N.value=!1}}},$=()=>{var u;(u=C.value)==null||u.resetFields(),Object.assign(o,{userId:null,userName:"",nickName:"",password:"",email:"",phonenumber:"",sex:"0",status:0,deptId:100,remark:""})};return ne(()=>{V()}),(u,l)=>{const m=n("el-input"),d=n("el-form-item"),S=n("el-option"),A=n("el-select"),J=n("Search"),c=n("el-icon"),_=n("el-button"),K=n("Refresh"),B=n("el-form"),Q=n("Plus"),G=n("el-row"),i=n("el-table-column"),H=n("el-tag"),W=n("Edit"),X=n("Delete"),Y=n("el-table"),Z=n("el-pagination"),h=n("el-card"),v=n("el-radio"),I=n("el-radio-group"),ee=n("el-dialog"),le=ue("loading");return z(),se("div",be,[e(h,null,{default:t(()=>[e(B,{inline:!0,model:s,class:"search-form"},{default:t(()=>[e(d,{label:"用户名"},{default:t(()=>[e(m,{modelValue:s.userName,"onUpdate:modelValue":l[0]||(l[0]=a=>s.userName=a),placeholder:"请输入用户名",clearable:""},null,8,["modelValue"])]),_:1}),e(d,{label:"手机号"},{default:t(()=>[e(m,{modelValue:s.phonenumber,"onUpdate:modelValue":l[1]||(l[1]=a=>s.phonenumber=a),placeholder:"请输入手机号",clearable:""},null,8,["modelValue"])]),_:1}),e(d,{label:"状态"},{default:t(()=>[e(A,{modelValue:s.status,"onUpdate:modelValue":l[2]||(l[2]=a=>s.status=a),placeholder:"请选择状态",clearable:""},{default:t(()=>[e(S,{label:"正常",value:0}),e(S,{label:"停用",value:1})]),_:1},8,["modelValue"])]),_:1}),e(d,null,{default:t(()=>[e(_,{type:"primary",onClick:k},{default:t(()=>[e(c,null,{default:t(()=>[e(J)]),_:1}),l[15]||(l[15]=r(" 搜索 ",-1))]),_:1}),e(_,{onClick:j},{default:t(()=>[e(c,null,{default:t(()=>[e(K)]),_:1}),l[16]||(l[16]=r(" 重置 ",-1))]),_:1})]),_:1})]),_:1},8,["model"]),e(G,{class:"toolbar"},{default:t(()=>[e(_,{type:"primary",onClick:L},{default:t(()=>[e(c,null,{default:t(()=>[e(Q)]),_:1}),l[17]||(l[17]=r(" 新增用户 ",-1))]),_:1})]),_:1}),re((z(),q(Y,{data:D.value,border:"",stripe:""},{default:t(()=>[e(i,{prop:"userId",label:"用户ID",width:"80"}),e(i,{prop:"userName",label:"用户名",width:"120"}),e(i,{prop:"nickName",label:"昵称",width:"120"}),e(i,{prop:"email",label:"邮箱",width:"180"}),e(i,{prop:"phonenumber",label:"手机号",width:"120"}),e(i,{prop:"sex",label:"性别",width:"80"},{default:t(({row:a})=>[de("span",null,F(a.sex==="0"?"男":a.sex==="1"?"女":"未知"),1)]),_:1}),e(i,{prop:"status",label:"状态",width:"80"},{default:t(({row:a})=>[e(H,{type:a.status===0?"success":"danger"},{default:t(()=>[r(F(a.status===0?"正常":"停用"),1)]),_:2},1032,["type"])]),_:1}),e(i,{prop:"createTime",label:"创建时间",width:"180"}),e(i,{label:"操作",fixed:"right",width:"200"},{default:t(({row:a})=>[e(_,{type:"primary",link:"",onClick:te=>M(a)},{default:t(()=>[e(c,null,{default:t(()=>[e(W)]),_:1}),l[18]||(l[18]=r(" 编辑 ",-1))]),_:1},8,["onClick"]),e(_,{type:"danger",link:"",onClick:te=>O(a)},{default:t(()=>[e(c,null,{default:t(()=>[e(X)]),_:1}),l[19]||(l[19]=r(" 删除 ",-1))]),_:1},8,["onClick"])]),_:1})]),_:1},8,["data"])),[[le,w.value]]),e(Z,{"current-page":s.page,"onUpdate:currentPage":l[3]||(l[3]=a=>s.page=a),"page-size":s.pageSize,"onUpdate:pageSize":l[4]||(l[4]=a=>s.pageSize=a),total:E.value,"page-sizes":[10,20,50,100],layout:"total, sizes, prev, pager, next, jumper",onSizeChange:k,onCurrentChange:k,class:"pagination"},null,8,["current-page","page-size","total"])]),_:1}),e(ee,{modelValue:b.value,"onUpdate:modelValue":l[14]||(l[14]=a=>b.value=a),title:x.value,width:"600px",onClose:$},{footer:t(()=>[e(_,{onClick:l[13]||(l[13]=a=>b.value=!1)},{default:t(()=>[...l[25]||(l[25]=[r("取消",-1)])]),_:1}),e(_,{type:"primary",onClick:P,loading:N.value},{default:t(()=>[...l[26]||(l[26]=[r(" 确定 ",-1)])]),_:1},8,["loading"])]),default:t(()=>[e(B,{ref_key:"userFormRef",ref:C,model:o,rules:T,"label-width":"80px"},{default:t(()=>[e(d,{label:"用户名",prop:"userName"},{default:t(()=>[e(m,{modelValue:o.userName,"onUpdate:modelValue":l[5]||(l[5]=a=>o.userName=a),disabled:g.value},null,8,["modelValue","disabled"])]),_:1}),e(d,{label:"昵称",prop:"nickName"},{default:t(()=>[e(m,{modelValue:o.nickName,"onUpdate:modelValue":l[6]||(l[6]=a=>o.nickName=a)},null,8,["modelValue"])]),_:1}),g.value?ie("",!0):(z(),q(d,{key:0,label:"密码",prop:"password"},{default:t(()=>[e(m,{modelValue:o.password,"onUpdate:modelValue":l[7]||(l[7]=a=>o.password=a),type:"password","show-password":""},null,8,["modelValue"])]),_:1})),e(d,{label:"邮箱",prop:"email"},{default:t(()=>[e(m,{modelValue:o.email,"onUpdate:modelValue":l[8]||(l[8]=a=>o.email=a)},null,8,["modelValue"])]),_:1}),e(d,{label:"手机号",prop:"phonenumber"},{default:t(()=>[e(m,{modelValue:o.phonenumber,"onUpdate:modelValue":l[9]||(l[9]=a=>o.phonenumber=a)},null,8,["modelValue"])]),_:1}),e(d,{label:"性别",prop:"sex"},{default:t(()=>[e(I,{modelValue:o.sex,"onUpdate:modelValue":l[10]||(l[10]=a=>o.sex=a)},{default:t(()=>[e(v,{label:"0"},{default:t(()=>[...l[20]||(l[20]=[r("男",-1)])]),_:1}),e(v,{label:"1"},{default:t(()=>[...l[21]||(l[21]=[r("女",-1)])]),_:1}),e(v,{label:"2"},{default:t(()=>[...l[22]||(l[22]=[r("未知",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(d,{label:"状态",prop:"status"},{default:t(()=>[e(I,{modelValue:o.status,"onUpdate:modelValue":l[11]||(l[11]=a=>o.status=a)},{default:t(()=>[e(v,{label:0},{default:t(()=>[...l[23]||(l[23]=[r("正常",-1)])]),_:1}),e(v,{label:1},{default:t(()=>[...l[24]||(l[24]=[r("停用",-1)])]),_:1})]),_:1},8,["modelValue"])]),_:1}),e(d,{label:"备注",prop:"remark"},{default:t(()=>[e(m,{modelValue:o.remark,"onUpdate:modelValue":l[12]||(l[12]=a=>o.remark=a),type:"textarea",rows:3},null,8,["modelValue"])]),_:1})]),_:1},8,["model"])]),_:1},8,["modelValue","title"])])}}},ye=ae(ge,[["__scopeId","data-v-513e8e38"]]);export{ye as default};
