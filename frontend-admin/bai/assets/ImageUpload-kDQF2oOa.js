import{r as v,c as g,h as M,ak as n,B as u,z as p,C as a,D as l,E as d,W as V,u as m,O as D}from"./vue-vendor-BRUv3CCy.js";import{z as W,d as N,p as $,E as o}from"./element-plus-BcUKyH_i.js";import{u as A}from"./index-D6S6O2v3.js";import{_ as H}from"./_plugin-vue_export-helper-DlAUqK2U.js";const L={class:"image-upload"},O={key:0,class:"image-preview"},P=["src"],j={class:"image-overlay"},q={key:1,class:"upload-placeholder"},F={class:"upload-text"},G=["src"],J={__name:"ImageUpload",props:{modelValue:{type:String,default:""},placeholder:{type:String,default:"点击上传图片"},disabled:{type:Boolean,default:!1}},emits:["update:modelValue"],setup(i,{emit:w}){const _=i,f=w,y=A(),t=v(_.modelValue),c=v(!1),k=g(()=>"/api/v1/upload/image"),U=g(()=>({Authorization:`Bearer ${y.token}`})),h=e=>e?e.startsWith("http")?e:`/api${e}`:"",b=e=>{const r=e.type.startsWith("image/"),s=e.size/1024/1024<5;return r?s?!0:(o.error("图片大小不能超过 5MB!"),!1):(o.error("只能上传图片文件!"),!1)},B=e=>{e.code===0?(t.value=e.data.url,f("update:modelValue",e.data.url),o.success("上传成功")):o.error(e.message||"上传失败")},x=e=>{console.error("上传失败:",e),o.error("上传失败，请重试")},I=()=>{c.value=!0},S=()=>{t.value="",f("update:modelValue",""),o.success("已删除")};return M(()=>_.modelValue,e=>{t.value=e}),(e,r)=>{const s=n("el-icon"),z=n("el-upload"),C=n("el-dialog");return p(),u("div",L,[a(z,{action:k.value,headers:U.value,"show-file-list":!1,"on-success":B,"on-error":x,"before-upload":b,disabled:i.disabled,accept:"image/*"},{default:l(()=>[t.value?(p(),u("div",O,[d("img",{src:h(t.value),alt:"预览图"},null,8,P),d("div",j,[a(s,{class:"preview-icon",onClick:V(I,["stop"])},{default:l(()=>[a(m(W))]),_:1}),a(s,{class:"delete-icon",onClick:V(S,["stop"])},{default:l(()=>[a(m(N))]),_:1})])])):(p(),u("div",q,[a(s,{class:"upload-icon"},{default:l(()=>[a(m($))]),_:1}),d("div",F,D(i.placeholder),1)]))]),_:1},8,["action","headers","disabled"]),a(C,{modelValue:c.value,"onUpdate:modelValue":r[0]||(r[0]=E=>c.value=E),title:"图片预览",width:"800px"},{default:l(()=>[d("img",{src:h(t.value),alt:"预览图",style:{width:"100%"}},null,8,G)]),_:1},8,["modelValue"])])}}},X=H(J,[["__scopeId","data-v-ea5e8580"]]);export{X as I};
